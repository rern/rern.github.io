# Maintainer: rern <rernrern@gmail.com>

pkgname=python-upnpp
pkgver=0.26.1
pkgrel=1
pkgdesc="Python UPnP control interface based on libupnpp."
url="https://www.lesbonscomptes.com/upmpdcli/libupnpp-python/upnpp-python.html"
license=(LGPL2.1)
arch=(x86_64)
makedepends=(libnpupnp python-devtools swig)
source=(https://framagit.org/medoc92/libupnpp-bindings/-/archive/libupnpp-bindings-v$pkgver/libupnpp-bindings-libupnpp-bindings-v$pkgver.tar.gz)
sha256sums=('178436ed6d576b6b1474e8c4b1d5b35d61311a6ab71521590e0e8ddc313b69d1')

sourcedir=$pkgname-$pkgver
builddir=$sourcedir/build

package() {
	mkdir -p $builddir
	[[ ! -e $sourcedir ]] && cp -r $srcdir/libupnpp-bindings-libupnpp-bindings-v$pkgver $sourcedir
	arch-meson $sourcedir $builddir
	meson compile -C $builddir
	
	echo 'from setuptools import setup, find_packages
setup(
    name="upnpp",
    version="0.26.1",
	packages=find_packages(),
)
' > $sourcedir/setup.py
	env CFLAGS="-fcommon" python $sourcedir/setup.py install --prefix=/usr --root="$pkgdir" --optimize=1
}
